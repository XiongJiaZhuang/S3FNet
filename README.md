# S3FNet: Spatial-Spectral Similarity-Guided Fusion Network for Pansharpening

- Code for the paper: "Spatial-Spectral Similarity-Guided Fusion Network for Pansharpening", IJCAI 2025.

# Method

## Overall Structure

![S3FNet](./readme_image/s3fnet.jpg#pic_center)
Overall structure of our S3FNet. It contains three key parts. PAN and LRMS images firstly pass through a shallow feature
extraction(SFE) layer. Next, the extracted features enter a multi-branch asymmetric encoder with spatial, spectral and
fusion branches. Finally, the features are processed through a multi-scale reconstruction decoder incorporated with a
well-designed cross-feature multi-head attention fusion block (CMAFB) to generate the HRMS image.

## CMAFB

![CMAFB](./readme_image/CMAFB.jpg#pic_center)

It takes the features generated by the three branches in the encoder as input and produces fused features using spatial
cross-attention (SpeCA), spectral cross-attention (SpaCA) mechanisms, and a locally-enhanced feed-forward layer
(LeFF).

# Experimental Results

- Quantitative evalutaion results on WV3, GF2, WV2 datasets of PanCollection.

![table_compare](./readme_image/table_compare.jpg#pic_center)

- Qualitative evalutaion results on the WV3 dataset of PanCollection.

![wv3_compare](./readme_image/wv3_compare.jpg#pic_center)

# Get Started

## Dataset

- Datasets for pansharpening: [PanCollection](https://github.com/liangjiandeng/PanCollection).

## Installation and Requirements

```shell
git clone https://github.com/XiongJiaZhuang/S3FNet.git
cd S3FNet
pip install -r requirements.txt
```

```shell
# train
python train_gf2.py
# test
python test_gf2.py
```

# Contact
Thank you very much for your interest in my work.
If you would like to get in touch, please feel free to reach me via:
- Email: xjz19980901@gmail.com
- WeChat: Scan the following QR code to connect.

![QR code](./readme_image/wechat.png#pic_center)
